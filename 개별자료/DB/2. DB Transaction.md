## 2. DB Transaction

### “트랜잭션이란?”

> 데이터베이스의 **상태를 변화**시키기 위해 수행하는 **작업 단위**
>
- “상태를 변화시킨다” → **SQL 질의어**를 통해 DB에 접근하는 것
    - SELECT, INSERT, UPDATE, DELETE
- “작업 단위” → **SQL 명령문을 사람이 정하는 기준에 따라 정하는 것**
    - 예시 상황 : user A가 user B에게 만원을 송금한다.
    - user A의 계좌에서 만원을 차감한다 → UPDATE
    - user B의 계좌에 만원을 추가한다 → UPDATE
    - 현재의 작업 단위 : 출금 UPDATE + 입금 UPDATE
    - 이를 **하나의 트랜잭션**이라고 한다.
    - 두 개의 UPDATE 쿼리가 성공적으로 완료되어야 하나의 작업(트랜잭션)이 완료되는 것 (= **commit**)
    - 작업 단위에 속하는 쿼리 중 하나라도 실패하게 된다면 모든 쿼리문 작업을 취소함 (= **rollback**)

### “트랜잭션의 특징”

- **원자성(Atomicity)**
    - 트랜잭션이 DB에 모두 반영되거나, 모두 반영되지 않아야 한다.
- **일관성(Consistency)**
    - 트랜잭션의 작업 처리 결과는 항상 일관성있어야 한다.
- **독립성(Isolation)**
    - 둘 이상의 트랜잭션이 동시에 병행 실행되고 있을 때, 하나의 트랜잭션이 다른 트랜잭션 작업에 끼어들 수 없다.
- **지속성(Durability)**
    - 트랜잭션이 성공적으로 완료되었다면, 결과물은 영구 반영되어야 한다.

### “트랜잭션의 작업 상태 키워드”

- **Commit**
    - 하나의 트랜잭션이 성공적으로 끝났고, DB가 일관성있는 상태
- **Rollback**
    - 트랜잭션 작업 중 문제가 있어 비정상적으로 종료되어 트랜잭션의 원자성이 깨진 경우
    - 트랜잭션 연산 작업 직전 정상적인 상태로 돌아감